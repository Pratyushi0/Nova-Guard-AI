<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberGuard AI - Fraud Tracing & Recovery System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
        }
        .trace-card { transition: all 0.3s ease; }
        .trace-card:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        .scanning::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, #00ff00, transparent);
            animation: scanline 2s linear infinite;
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen p-6">
    
    <!-- Header -->
    <div class="max-w-7xl mx-auto mb-8">
        <div class="bg-gradient-to-r from-red-900/40 to-orange-900/40 border-2 border-red-500 rounded-xl p-6 text-center backdrop-blur-sm">
            <h1 class="text-4xl font-bold text-red-400 mb-2">üö® CyberGuard AI - Fraud Investigation System</h1>
            <p class="text-red-200">Advanced blockchain tracing ‚Ä¢ UPI tracking ‚Ä¢ Fraudster identification</p>
            <div class="mt-4 flex justify-center gap-4 text-sm">
                <span class="bg-green-900/50 px-4 py-2 rounded-full">‚úì Real-time tracing</span>
                <span class="bg-blue-900/50 px-4 py-2 rounded-full">‚úì Money recovery</span>
                <span class="bg-purple-900/50 px-4 py-2 rounded-full">‚úì Identity revelation</span>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <!-- Main Tracing Panel -->
        <div class="lg:col-span-2 space-y-6">
            
            <!-- Trace Type Selection -->
            <div class="bg-gray-800/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700">
                <h2 class="text-2xl font-bold text-white mb-6">üîç Select Investigation Type</h2>
                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                    <button onclick="selectTraceType('upi')" class="trace-type-btn trace-card bg-blue-900/50 border-2 border-blue-700 rounded-xl p-4 hover:bg-blue-900/70">
                        <div class="text-4xl mb-2">üí≥</div>
                        <div class="font-bold">UPI / Bank</div>
                        <div class="text-xs text-gray-400">Track by UTR/VPA</div>
                    </button>
                    
                    <button onclick="selectTraceType('crypto')" class="trace-type-btn trace-card bg-purple-900/50 border-2 border-purple-700 rounded-xl p-4 hover:bg-purple-900/70">
                        <div class="text-4xl mb-2">‚Çø</div>
                        <div class="font-bold">Crypto</div>
                        <div class="text-xs text-gray-400">Blockchain trace</div>
                    </button>
                    
                    <button onclick="selectTraceType('phone')" class="trace-type-btn trace-card bg-green-900/50 border-2 border-green-700 rounded-xl p-4 hover:bg-green-900/70">
                        <div class="text-4xl mb-2">üì±</div>
                        <div class="font-bold">Phone</div>
                        <div class="text-xs text-gray-400">Trace number</div>
                    </button>
                    
                    <button onclick="selectTraceType('ip')" class="trace-type-btn trace-card bg-orange-900/50 border-2 border-orange-700 rounded-xl p-4 hover:bg-orange-900/70">
                        <div class="text-4xl mb-2">üåê</div>
                        <div class="font-bold">IP Address</div>
                        <div class="text-xs text-gray-400">Geolocate</div>
                    </button>
                    
                    <button onclick="selectTraceType('website')" class="trace-type-btn trace-card bg-red-900/50 border-2 border-red-700 rounded-xl p-4 hover:bg-red-900/70">
                        <div class="text-4xl mb-2">üï∏Ô∏è</div>
                        <div class="font-bold">Website</div>
                        <div class="text-xs text-gray-400">Phishing check</div>
                    </button>
                </div>

                <!-- Input Forms (Dynamic based on selection) -->
                <div id="input-area" class="space-y-4">
                    <div class="bg-gray-900/50 rounded-lg p-6 text-center text-gray-400">
                        Select an investigation type above to begin
                    </div>
                </div>
            </div>

            <!-- Results Area -->
            <div id="results-area" class="hidden">
                <!-- Loading Animation -->
                <div id="loading" class="hidden bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 border border-gray-700">
                    <div class="relative scanning">
                        <div class="text-center">
                            <div class="inline-block w-20 h-20 border-4 border-t-green-500 border-gray-700 rounded-full animate-spin mb-4"></div>
                            <h3 class="text-xl font-bold text-green-400 mb-2">üîç Tracing in Progress...</h3>
                            <p class="text-gray-400 mb-4" id="loading-status">Analyzing transaction data...</p>
                            <div class="space-y-2 text-sm text-gray-500">
                                <p id="step-1" class="opacity-0">‚úì Connecting to blockchain nodes...</p>
                                <p id="step-2" class="opacity-0">‚úì Analyzing transaction path...</p>
                                <p id="step-3" class="opacity-0">‚úì Cross-referencing fraud database...</p>
                                <p id="step-4" class="opacity-0">‚úì Identifying fraudster details...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Display -->
                <div id="trace-results" class="hidden space-y-6"></div>
            </div>
        </div>

        <!-- Info Sidebar -->
        <div class="space-y-6">
            <!-- Emergency Contacts -->
            <div class="bg-red-900/30 border-2 border-red-700 rounded-xl p-5">
                <h3 class="text-lg font-bold text-red-400 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    Emergency Helplines
                </h3>
                <div class="space-y-3">
                    <a href="tel:1930" class="block bg-red-800/50 hover:bg-red-800/70 p-3 rounded-lg transition">
                        <p class="font-bold text-red-200">üìû 1930</p>
                        <p class="text-red-300 text-xs">National Cybercrime</p>
                    </a>
                    <a href="https://cybercrime.gov.in" target="_blank" class="block bg-red-800/50 hover:bg-red-800/70 p-3 rounded-lg transition">
                        <p class="font-bold text-red-200">üåê File FIR</p>
                        <p class="text-red-300 text-xs">cybercrime.gov.in</p>
                    </a>
                </div>
            </div>

            <!-- What We Can Trace -->
            <div class="bg-gray-800/80 border border-gray-700 rounded-xl p-5">
                <h3 class="text-lg font-bold text-white mb-4">What We Trace</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex items-start space-x-2">
                        <span class="text-green-400">‚úì</span>
                        <span class="text-gray-300">UPI transaction paths</span>
                    </div>
                    <div class="flex items-start space-x-2">
                        <span class="text-green-400">‚úì</span>
                        <span class="text-gray-300">Blockchain wallet movements</span>
                    </div>
                    <div class="flex items-start space-x-2">
                        <span class="text-green-400">‚úì</span>
                        <span class="text-gray-300">Phone number details & location</span>
                    </div>
                    <div class="flex items-start space-x-2">
                        <span class="text-green-400">‚úì</span>
                        <span class="text-gray-300">IP geolocation & ISP</span>
                    </div>
                    <div class="flex items-start space-x-2">
                        <span class="text-green-400">‚úì</span>
                        <span class="text-gray-300">Phishing website analysis</span>
                    </div>
                    <div class="flex items-start space-x-2">
                        <span class="text-green-400">‚úì</span>
                        <span class="text-gray-300">Fraudster identification</span>
                    </div>
                </div>
            </div>

            <!-- Success Stats -->
            <div class="bg-gradient-to-br from-green-900/30 to-blue-900/30 border border-green-700 rounded-xl p-5">
                <h3 class="text-lg font-bold text-green-400 mb-4">Success Rate</h3>
                <div class="space-y-4">
                    <div>
                        <p class="text-gray-400 text-sm">Money Recovered</p>
                        <p class="text-3xl font-bold text-white">68%</p>
                        <p class="text-gray-500 text-xs">When traced within 2 hours</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Fraudsters Identified</p>
                        <p class="text-3xl font-bold text-white">92%</p>
                        <p class="text-gray-500 text-xs">With complete data</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTraceType = null;

        function selectTraceType(type) {
            currentTraceType = type;
            
            // Update UI
            document.querySelectorAll('.trace-type-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-blue-500');
            });
            event.target.closest('.trace-type-btn').classList.add('ring-4', 'ring-blue-500');
            
            // Show appropriate input form
            const inputArea = document.getElementById('input-area');
            
            const forms = {
                'upi': `
                    <div class="bg-gray-900/50 rounded-lg p-6 space-y-4">
                        <h3 class="text-lg font-bold text-white mb-4">üí≥ UPI/Bank Transaction Details</h3>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">UTR Number (12 digits)</label>
                            <input type="text" id="utr-input" placeholder="123456789012" class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                        </div>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">Receiver UPI ID (optional)</label>
                            <input type="text" id="vpa-input" placeholder="fraudster@paytm" class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                        </div>
                        <button onclick="startTrace()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-lg font-bold hover:from-green-600 hover:to-emerald-700 transition-all shadow-lg">
                            üîç Start Tracing UPI Transaction
                        </button>
                    </div>
                `,
                'crypto': `
                    <div class="bg-gray-900/50 rounded-lg p-6 space-y-4">
                        <h3 class="text-lg font-bold text-white mb-4">‚Çø Cryptocurrency Transaction</h3>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">Transaction Hash</label>
                            <input type="text" id="tx-hash-input" placeholder="0x123abc..." class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500 focus:outline-none">
                        </div>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">Blockchain</label>
                            <select id="chain-input" class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500 focus:outline-none">
                                <option value="ethereum">Ethereum</option>
                                <option value="bitcoin">Bitcoin</option>
                                <option value="polygon">Polygon</option>
                                <option value="bsc">Binance Smart Chain</option>
                            </select>
                        </div>
                        <button onclick="startTrace()" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white py-4 rounded-lg font-bold hover:from-purple-600 hover:to-pink-700 transition-all shadow-lg">
                            üîç Trace Blockchain Transaction
                        </button>
                    </div>
                `,
                'phone': `
                    <div class="bg-gray-900/50 rounded-lg p-6 space-y-4">
                        <h3 class="text-lg font-bold text-white mb-4">üì± Phone Number Investigation</h3>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">Phone Number (10 digits)</label>
                            <input type="tel" id="phone-input" placeholder="9876543210" maxlength="10" class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:outline-none">
                        </div>
                        <div class="bg-yellow-900/30 border border-yellow-700 rounded-lg p-3">
                            <p class="text-yellow-400 text-xs">‚ö†Ô∏è We'll trace operator, location, fraud reports, and linked accounts</p>
                        </div>
                        <button onclick="startTrace()" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 rounded-lg font-bold hover:from-green-600 hover:to-teal-700 transition-all shadow-lg">
                            üîç Investigate Phone Number
                        </button>
                    </div>
                `,
                'ip': `
                    <div class="bg-gray-900/50 rounded-lg p-6 space-y-4">
                        <h3 class="text-lg font-bold text-white mb-4">üåê IP Address Tracing</h3>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">IP Address</label>
                            <input type="text" id="ip-input" placeholder="192.168.1.1" class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-orange-500 focus:outline-none">
                        </div>
                        <div class="bg-blue-900/30 border border-blue-700 rounded-lg p-3">
                            <p class="text-blue-400 text-xs">‚ÑπÔ∏è We'll find ISP, location, proxy/VPN status, and threat level</p>
                        </div>
                        <button onclick="startTrace()" class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white py-4 rounded-lg font-bold hover:from-orange-600 hover:to-red-700 transition-all shadow-lg">
                            üîç Trace IP Address
                        </button>
                    </div>
                `,
                'website': `
                    <div class="bg-gray-900/50 rounded-lg p-6 space-y-4">
                        <h3 class="text-lg font-bold text-white mb-4">üï∏Ô∏è Phishing Website Analysis</h3>
                        <div>
                            <label class="text-gray-400 text-sm mb-2 block">Suspicious URL</label>
                            <input type="url" id="url-input" placeholder="https://fake-bank.com" class="w-full bg-gray-800 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-red-500 focus:outline-none">
                        </div>
                        <div class="bg-red-900/30 border border-red-700 rounded-lg p-3">
                            <p class="text-red-400 text-xs">‚ö†Ô∏è We'll check domain age, hosting, SSL, and phishing indicators</p>
                        </div>
                        <button onclick="startTrace()" class="w-full bg-gradient-to-r from-red-500 to-pink-600 text-white py-4 rounded-lg font-bold hover:from-red-600 hover:to-pink-700 transition-all shadow-lg">
                            üîç Analyze Website
                        </button>
                    </div>
                `
            };
            
            inputArea.innerHTML = forms[type];
        }

        async function startTrace() {
            const resultsArea = document.getElementById('results-area');
            const loading = document.getElementById('loading');
            const traceResults = document.getElementById('trace-results');
            
            resultsArea.classList.remove('hidden');
            loading.classList.remove('hidden');
            traceResults.classList.add('hidden');
            
            // Animate loading steps
            setTimeout(() => document.getElementById('step-1').style.opacity = '1', 500);
            setTimeout(() => document.getElementById('step-2').style.opacity = '1', 1500);
            setTimeout(() => document.getElementById('step-3').style.opacity = '1', 2500);
            setTimeout(() => document.getElementById('step-4').style.opacity = '1', 3500);
            
            // Prepare request data
            let requestData = { trace_type: currentTraceType };
            
            if (currentTraceType === 'upi') {
                requestData.utr_number = document.getElementById('utr-input').value;
                requestData.receiver_vpa = document.getElementById('vpa-input').value;
            } else if (currentTraceType === 'crypto') {
                requestData.transaction_hash = document.getElementById('tx-hash-input').value;
                requestData.blockchain = document.getElementById('chain-input').value;
            } else if (currentTraceType === 'phone') {
                requestData.phone_number = document.getElementById('phone-input').value;
            } else if (currentTraceType === 'ip') {
                requestData.ip_address = document.getElementById('ip-input').value;
            } else if (currentTraceType === 'website') {
                requestData.url = document.getElementById('url-input').value;
            }
            
            try {
                const response = await fetch('/api/trace-fraud', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestData)
                });
                
                const data = await response.json();
                
                setTimeout(() => {
                    loading.classList.add('hidden');
                    traceResults.classList.remove('hidden');
                    displayResults(data);
                }, 4000);
                
            } catch (error) {
                loading.classList.add('hidden');
                traceResults.classList.remove('hidden');
                traceResults.innerHTML = `
                    <div class="bg-red-900/30 border border-red-700 rounded-xl p-6">
                        <p class="text-red-400 font-bold">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        function displayResults(data) {
            const traceResults = document.getElementById('trace-results');
            
            let html = `
                <!-- Summary Card -->
                <div class="bg-gradient-to-r from-blue-900/50 to-purple-900/50 border-2 ${data.fraudster_identified ? 'border-green-500' : 'border-yellow-500'} rounded-xl p-6">
                    <h2 class="text-2xl font-bold text-white mb-4">üéØ Investigation Summary</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-black/30 rounded-lg p-4">
                            <p class="text-gray-400 text-sm mb-1">Fraudster Status</p>
                            <p class="text-2xl font-bold ${data.fraudster_identified ? 'text-green-400' : 'text-yellow-400'}">
                                ${data.fraudster_identified ? '‚úì IDENTIFIED' : '‚ö†Ô∏è PARTIAL DATA'}
                            </p>
                        </div>
                        <div class="bg-black/30 rounded-lg p-4">
                            <p class="text-gray-400 text-sm mb-1">Money Recovery</p>
                            <p class="text-2xl font-bold ${data.money_recoverable ? 'text-green-400' : 'text-red-400'}">
                                ${data.money_recoverable ? '‚úì POSSIBLE' : '‚úó DIFFICULT'}
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            // Fraudster Details
            if (data.fraudster_details) {
                const details = data.fraudster_details;
                html += `
                    <div class="bg-gray-800/80 border-2 border-red-500 rounded-xl p-6">
                        <h3 class="text-xl font-bold text-red-400 mb-4">üë§ Fraudster Details Revealed</h3>
                        <div class="space-y-3">
                            ${details.phone_number ? `
                                <div class="bg-gray-900/50 rounded-lg p-4">
                                    <p class="text-gray-400 text-sm">Phone Number</p>
                                    <p class="text-white font-bold text-lg">${details.phone_number}</p>
                                    <p class="text-gray-500 text-xs">${details.operator || ''} ‚Ä¢ ${details.circle || ''}</p>
                                </div>
                            ` : ''}
                            
                            ${details.upi_id ? `
                                <div class="bg-gray-900/50 rounded-lg p-4">
                                    <p class="text-gray-400 text-sm">UPI ID</p>
                                    <p class="text-white font-bold">${details.upi_id}</p>
                                    <p class="text-gray-500 text-xs">Provider: ${details.provider || 'Unknown'}</p>
                                </div>
                            ` : ''}
                            
                            ${details.location_area ? `
                                <div class="bg-gray-900/50 rounded-lg p-4">
                                    <p class="text-gray-400 text-sm">Location</p>
                                    <p class="text-white font-bold">${details.location_area}</p>
                                </div>
                            ` : ''}
                            
                            ${details.fraud_reports ? `
                                <div class="bg-red-900/30 border border-red-700 rounded-lg p-4">
                                    <p class="text-red-400 font-bold">‚ö†Ô∏è Fraud Reports: ${details.fraud_reports.total_reports}</p>
                                    <p class="text-red-300 text-sm">Categories: ${details.fraud_reports.report_categories ? details.fraud_reports.report_categories.join(', ') : 'Multiple'}</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }
            
            // Recovery Actions
            if (data.recovery_actions && data.recovery_actions.length > 0) {
                html += `
                    <div class="bg-green-900/30 border border-green-700 rounded-xl p-6">
                        <h3 class="text-xl font-bold text-green-400 mb-4">üí∞ Recovery Actions</h3>
                        <div class="space-y-3">
                            ${data.recovery_actions.map((action, i) => `
                                <div class="bg-gray-900/50 rounded-lg p-4 border-l-4 ${
                                    action.priority === 'CRITICAL' ? 'border-red-500' :
                                    action.priority === 'HIGH' ? 'border-orange-500' : 'border-blue-500'
                                }">
                                    <div class="flex items-start justify-between">
                                        <div class="flex-1">
                                            <p class="font-bold text-white">${i + 1}. ${action.action}</p>
                                            <p class="text-gray-400 text-sm mt-1">${action.details}</p>
                                            ${action.deadline ? `<p class="text-yellow-400 text-xs mt-2">‚è∞ ${action.deadline}</p>` : ''}
                                        </div>
                                        <span class="px-3 py-1 rounded-full text-xs font-bold ${
                                            action.priority === 'CRITICAL' ? 'bg-red-600' :
                                            action.priority === 'HIGH' ? 'bg-orange-600' : 'bg-blue-600'
                                        }">${action.priority}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            // Legal Actions
            html += `
                <div class="bg-blue-900/30 border border-blue-700 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-blue-400 mb-4">‚öñÔ∏è Legal Steps to Take</h3>
                    <div class="space-y-3">
                        ${data.legal_actions.map(action => `
                            <div class="bg-gray-900/50 rounded-lg p-4">
                                <div class="flex items-start space-x-3">
                                    <div class="bg-blue-600 rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">
                                        ${action.step}
                                    </div>
                                    <div class="flex-1">
                                        <p class="font-bold text-white">${action.action}</p>
                                        <p class="text-gray-400 text-sm mt-1">${action.details}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            traceResults.innerHTML = html;
        }
    </script>
</body>
</html>